{"version":3,"sources":["../../../src/credentials/views/SetupIosDist.ts"],"names":["SetupIosDist","constructor","app","nonInteractive","open","ctx","user","Error","configuredDistCert","ios","getDistCert","isValid","iosDistView","validateDistributionCertificate","CreateOrReuseDistributionCert"],"mappings":";;;;;;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;AAEO,MAAMA,YAAN,CAAoC;AACzCC,EAAAA,WAAW,CAASC,GAAT,EAAuCC,cAAuB,GAAG,KAAjE,EAAwE;AAAA,SAA/DD,GAA+D,GAA/DA,GAA+D;AAAA,SAAjCC,cAAiC,GAAjCA,cAAiC;AAAE;;AAErF,QAAMC,IAAN,CAAWC,GAAX,EAAgD;AAC9C,QAAI,CAACA,GAAG,CAACC,IAAT,EAAe;AACb,YAAM,IAAIC,KAAJ,CAAW,6CAAX,CAAN;AACD;;AAED,UAAMC,kBAAkB,GAAG,MAAMH,GAAG,CAACI,GAAJ,CAAQC,WAAR,CAAoB,KAAKR,GAAzB,CAAjC;;AAEA,QAAIM,kBAAJ,EAAwB;AACtB;AACA,YAAMG,OAAO,GAAG,MAAMC,WAAW,GAACC,+BAAZ,CAA4CR,GAA5C,EAAiDG,kBAAjD,CAAtB;;AACA,UAAIG,OAAJ,EAAa;AACX,eAAO,IAAP;AACD;AACF;;AAED,WAAO,KAAIC,WAAW,GAACE,6BAAhB,EAA8C,KAAKZ,GAAnD,EAAwD,KAAKC,cAA7D,CAAP;AACD;;AAnBwC","sourcesContent":["import { AppLookupParams } from '../api/IosApi';\nimport { Context, IView } from '../context';\nimport * as iosDistView from './IosDistCert';\n\nexport class SetupIosDist implements IView {\n  constructor(private app: AppLookupParams, private nonInteractive: boolean = false) {}\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const configuredDistCert = await ctx.ios.getDistCert(this.app);\n\n    if (configuredDistCert) {\n      // we dont need to setup if we have a valid dist cert on file\n      const isValid = await iosDistView.validateDistributionCertificate(ctx, configuredDistCert);\n      if (isValid) {\n        return null;\n      }\n    }\n\n    return new iosDistView.CreateOrReuseDistributionCert(this.app, this.nonInteractive);\n  }\n}\n"],"file":"SetupIosDist.js"}